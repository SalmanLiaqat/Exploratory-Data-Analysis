--Ranking Analysis

--which 5 product generate the highest revenue
SELECT TOP 5
product_name,
SUM(sales_Amount) AS total_revenue
FROM gold.fact_sales
LEFT JOIN gold.dim_products
ON fact_sales.product_key = dim_products.product_key
GROUP BY product_name
ORDER BY total_revenue DESC


--using subquery
SELECT *
FROM(
	SELECT 
	product_name,
	SUM(sales_Amount) AS total_revenue,
	ROW_NUMBER() OVER(ORDER BY SUM(sales_Amount) DESC) AS Rank_product
	FROM gold.fact_sales
	LEFT JOIN gold.dim_products
	ON fact_sales.product_key = dim_products.product_key
	GROUP BY product_name)t
WHERE Rank_product <=5

--what are the 5 worst performing products

SELECT TOP 5
product_name,
SUM(sales_Amount) AS total_revenue
FROM gold.fact_sales
LEFT JOIN gold.dim_products
ON fact_sales.product_key = dim_products.product_key
GROUP BY product_name
ORDER BY total_revenue
